const { inspect } = require('util')

class Event extends require('events') {

  constructor(_={}) {
    for (let e in super()._=_) if (e !== 'entity' && _[e] !== undefined) super[e] = _[e]
    //> entity is resolved correctly below as this.target.name
  }

  get headers(){ return super.headers = this._.req && this._.req.headers || {} }
  get entity() { return super.entity = this.target && this.target.name }
  get data(){ return super.data = {} }

  set entity(e){ super.entity = e }
  set data(d){ super.data = d }

  toString() { return `${this.event} ${this.entity}` }
  [inspect.custom]() { return inspect (this._) }
}

module.exports = Event
